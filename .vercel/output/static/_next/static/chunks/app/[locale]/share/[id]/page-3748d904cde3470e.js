(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[595],{2253:function(e,t,n){Promise.resolve().then(n.bind(n,8385))},8385:function(e,t,n){"use strict";n.d(t,{getShareCard:function(){return g},tS:function(){return f},mr:function(){return p}});var o=n(5969),r=n(1988);async function i(e,t){let n=new TextEncoder,o=await crypto.subtle.importKey("raw",n.encode(e),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",o,n.encode(t)))).map(e=>e.toString(16).padStart(2,"0")).join("")}var c=n(7200),a=n(4859);let s=(()=>{if(a.env.NEXT_PUBLIC_API_BASE_URL)return a.env.NEXT_PUBLIC_API_BASE_URL;{let e=a.env.NEXT_PUBLIC_DOMAIN||"astropal.io";return"https://api.".concat(e)}})(),l=a.env.NEXT_PUBLIC_HMAC_SECRET||"";async function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(s).concat(e),o=t.body,r=new Headers({"Content-Type":"application/json"});if(t.headers&&new Headers(t.headers).forEach((e,t)=>{r.set(t,e)}),o&&l){let e=await i(l,o);r.set("X-APIsig",e)}c.k.log("debug","API request initiated",{endpoint:e,url:n,method:t.method||"GET",hasBody:!!o,component:"api-client"});let a=await fetch(n,{...t,headers:r});if(!a.ok){let t=Error("API Error: ".concat(a.status));throw c.k.error("API request failed",{endpoint:e,url:n,status:a.status,statusText:a.statusText,error:t.message,component:"api-client"}),t}let u=await a.json();return c.k.log("debug","API request successful",{endpoint:e,status:a.status,component:"api-client"}),u}c.k.log("info","API configuration initialized",{apiBase:s,environment:"production",hasHmacSecret:!!l,component:"api-client"});let d=async e=>{c.k.log("info","User registration attempt",{email:e.email,focuses:e.focuses,locale:e.locale,component:"api-client"});let t=e=>e.includes("evidence-based")?"evidence":e.includes("career")?"success":e.includes("social")?"knowledge":"calm";try{var n;let o=await u("/register",{method:"POST",body:JSON.stringify({email:e.email,birthDate:e.dob,birthLocation:e.birthLocation,birthTime:"12:00",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,locale:e.locale||"en-US",perspective:t(e.focuses),focusAreas:e.focuses||[],referralCode:e.referral})});return c.k.log("info","User registration successful",{userId:null===(n=o.user)||void 0===n?void 0:n.id,traceId:o.traceId,perspective:t(e.focuses),component:"api-client"}),o}catch(t){throw c.k.error("Registration API error",{email:e.email,error:t.message,component:"api-client"}),t}},m=async()=>u("/pricing"),g=async e=>u("/share/".concat(e)),p=()=>(0,o.D)({mutationFn:d,onError:e=>{c.k.error("Registration mutation error",{error:e.message,component:"api-hooks"})},onSuccess:e=>{var t;c.k.log("info","Registration mutation success",{success:e.success,userId:null===(t=e.user)||void 0===t?void 0:t.id,component:"api-hooks"})}}),f=()=>(0,r.a)({queryKey:["pricing"],queryFn:m,staleTime:3e5})},7200:function(e,t,n){"use strict";n.d(t,{k:function(){return i},w:function(){return c}});var o=n(7653);class r{log(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};({timestamp:new Date().toISOString(),component:n.component||"unknown",...n})}debug(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("debug",e,t)}info(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("info",e,t)}warn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("warn",e,t)}error(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("error",e,t)}constructor(){this.currentLevel="warn"}}let i=new r,c=e=>((0,o.useEffect)(()=>(i.debug("".concat(e," mounted"),{component:e}),()=>i.debug("".concat(e," unmounted"),{component:e})),[e]),{logUserAction:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.info("User: ".concat(t),{component:e,action:t,...n})},logError:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.error("Error in ".concat(e),{component:e,error:t.message,...n})},logInfo:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.info("".concat(e,": ").concat(t),{component:e,...n})},logWarn:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.warn("".concat(e,": ").concat(t),{component:e,...n})}})}},function(e){e.O(0,[953,77,293,456,744],function(){return e(e.s=2253)}),_N_E=e.O()}]);